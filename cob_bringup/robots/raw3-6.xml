<?xml version="1.0"?>
<launch>

  <!-- args -->
  <arg name="robot" value="raw3-6"/>
  <arg name="pc1" default="localhost"/>
  <arg name="env-script" default="$(find cob_bringup)/env.sh"/>
  <arg name="ur_ip" default="192.168.1.40" />
  <arg name="gripper_ip" default="192.168.1.11" />
  <arg name="sim" default="false"/>

  <!-- upload robot description -->
  <include file="$(find cob_hardware_config)/upload_robot.launch" >
    <arg name="robot" value="$(arg robot)" />
  </include>

  <!-- upload default configuration parameters -->
  <include file="$(find cob_default_robot_config)/upload_param.launch" >
    <arg name="robot" value="$(arg robot)" />
  </include>

  <group>
    <machine name="pc1" address="$(arg pc1)" env-loader="$(arg env-script)" default="true"/>

    <!--start hardware-->
    <group unless="$(arg sim)">
      <include file="$(find cob_bringup)/tools/pc_monitor.launch" >
        <arg name="robot" value="$(arg robot)" />
        <arg name="pc" value="$(arg pc1)" />
      </include>

      <!--
      <include file="$(find cob_bringup)/tools/wifi_monitor.launch" /> 
        <arg name="robot" value="$(arg robot)" />
      </include>
      -->

      <include file="$(find cob_bringup)/drivers/phidgets.launch" >
        <arg name="robot" value="$(arg robot)" />
      </include>

      <include file="$(find cob_bringup)/drivers/powerstate_phidget.launch">
        <arg name="robot" value="$(arg robot)"/>
      </include>

      <include file="$(find cob_bringup)/drivers/emstate_phidget.launch">
        <arg name="robot" value="$(arg robot)"/>
      </include>
    </group>

    <include file="$(find cob_bringup)/drivers/sick_s300.launch" >
      <arg name="robot" value="$(arg robot)" />
      <arg name="name" value="base_laser_front" />
      <arg name="sim" value="$(arg sim)"/>
    </include>

    <include file="$(find cob_bringup)/drivers/sick_s300.launch" >
      <arg name="robot" value="$(arg robot)" />
      <arg name="name" value="base_laser_rear" />
      <arg name="sim" value="$(arg sim)"/>
    </include>

    <!-- lower robot -->
    <include file="$(find cob_bringup)/components/legacy_base.launch">
      <arg name="robot" value="$(arg robot)"/>
      <arg name="sim" value="$(arg sim)"/>
    </include>

    <!--brad-->
    <!--
    <include file="$(find cob_bringup)/drivers/base_driver.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>
    <include file="$(find cob_bringup)/controllers/base_controller.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>
    -->

    <!-- upper robot -->
    <include file="$(find cob_bringup)/drivers/ur.launch">
      <arg name="robot" value="$(arg robot)"/>
      <arg name="component_name" value="arm"/>
      <arg name="robot_ip" value="$(arg ur_ip)"/>
      <arg name="min_payload"  value="0.0"/>
      <arg name="max_payload"  value="20.0"/>
      <arg name="sim" value="$(arg sim)"/>
    </include>
    <!--
    <include file="$(find yuripy)/launch/planning/moveit/move_group.launch" />
    -->

    <!--???-->
    <!-- Robotiq gripper -->
    <!--<include file="$(find cob_bringup)/drivers/robotiq.launch">-->
      <!--<arg name="robot_ip" value="$(arg gripper_ip)"/>-->
      <!--<arg name="prefix" value="gripper_"/>-->
    <!--</include>-->

    <include file="$(find cob_bringup)/drivers/scan_unifier.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>

    <!-- start additional packages -->
    <include file="$(find cob_bringup)/tools/diagnostics_aggregator.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>

    <!--
    <include file="$(find cob_bringup)/tools/teleop.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>
    -->
  
    <include file="$(find cob_bringup)/tools/base_collision_observer.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>

    <include file="$(find cob_bringup)/tools/battery_monitor.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>


    <include file="$(find cob_bringup)/tools/emergency_stop_monitor.launch" >
      <arg name="robot" value="$(arg robot)" />
    </include>

    <!-- aggregated robot_state_publisher -->
    <include file="$(find cob_bringup)/tools/robot_state_publisher.launch">
      <arg name="robot" value="$(arg robot)" />
    </include>

    <!-- script server -->
    <include file="$(find cob_script_server)/launch/script_server.launch" />

  </group>

  <machine name="pc1" address="$(arg pc1)" env-loader="$(find cob_bringup)/env.sh" default="true"/>

</launch>
